<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
	PUBLIC "-//mybatis.org/DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="ath001m">
	
	<select id= "listAll" resultType="kr.co.ibk.itep.dto.AthJoinedEmpJoinedBri" >

	SELECT A.EMN, A.EMM, A.AUTH_CD, B.AUTH_NM, C.KRN_BRM, B.REG_DT, B.CHG_DT
	FROM TB_IEP_EMP001M A, TB_IEP_ATH001M B, TB_IEP_BRI001M C
	WHERE A.AUTH_CD = B.AUTH_CD AND A.BLNG_BRCD = C.BRCD
   <!--  <inculde refid="search"> </inculde> --> 
	
	</select>
 	
 	<!-- 반복되는 sql 떼어 놓기 -->
	<sql id = "search">
	<choose>
		<!-- 검색옵션이 전체 검색일 경우 -->
		<when test="searchOption =='all'">
		 WHERE branch like '%'||#{keyword}||%'
		 OR authority like '%'||#{keyword}||'%'
		</when>
		<!-- 전체 검색이 아닐 경우 -->
		<otherwise>
			WHERE ${searchOption} like '%'||#keyword||'%'
		</otherwise>
	</choose>
	</sql>
	
</mapper>

